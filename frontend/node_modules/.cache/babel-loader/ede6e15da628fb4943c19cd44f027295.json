{"ast":null,"code":"import CartContext from '../../context/CartContext'; // Import CartContext import './index.css'; const Login = props => ( <CartContext.Consumer> {value => { const { getCartList} = value; const onSubmit = async event => { event.preventDefault(); const { username, password } = state; const userData = { username, password }; const url = 'http://localhost:3000/login/'; // Backend login endpoint const options = { method: 'POST', headers: { 'Content-Type': 'application/json', }, body: JSON.stringify(userData), }; try { const req = await fetch(url, options); const res = await req.json(); if (req.ok) { const { history } = props; const jwtToken = res.jwtToken; const userId = res.userId; // Save JWT and userId to localStorage localStorage.setItem('jwt_token', jwtToken); localStorage.setItem('user_id', userId); getCartList(userId); // Fetch user cart list history.replace('/'); // Redirect to home page on success } else { setState({ errorMsg: res.error_msg || 'Login failed. Please try again.' }); } } catch (error) { setState({ errorMsg: 'Wrong username or password' }); } }; const [state, setState] = React.useState({ username: '', password: '', errorMsg: '', }); const onChangeUsername = event => { setState(prevState => ({ ...prevState, username: event.target.value })); }; const onChangePassword = event => { setState(prevState => ({ ...prevState, password: event.target.value })); }; const { username, password, errorMsg } = state; return ( <div className=\"login-con\"> <div className=\"login-card\"> <h1 className=\"HomeLogo\">shoppy</h1> <form className=\"form\" onSubmit={onSubmit}> <label className=\"label\" htmlFor=\"user\"> USERNAME </label> <input className=\"inp\" type=\"text\" id=\"user\" onChange={onChangeUsername} value={username} placeholder=\"Enter your username\" /> <label className=\"label\" htmlFor=\"pass\"> PASSWORD </label> <input className=\"inp\" type=\"password\" id=\"pass\" onChange={onChangePassword} value={password} placeholder=\"Enter your password\" /> <button type=\"submit\" className=\"login-btn\"> Login </button> {errorMsg && <p className=\"err-msg\">{errorMsg}</p>} </form> </div> </div> ); }} </CartContext.Consumer> ); export","map":{"version":3,"names":["CartContext"],"sources":["C:/Users/prabh/my-fullstack-app/frontend/src/components/Login/index.js"],"sourcesContent":["\r\nimport CartContext from '../../context/CartContext'; // Import CartContext import './index.css'; const Login = props => ( <CartContext.Consumer> {value => { const { getCartList} = value; const onSubmit = async event => { event.preventDefault(); const { username, password } = state; const userData = { username, password }; const url = 'http://localhost:3000/login/'; // Backend login endpoint const options = { method: 'POST', headers: { 'Content-Type': 'application/json', }, body: JSON.stringify(userData), }; try { const req = await fetch(url, options); const res = await req.json(); if (req.ok) { const { history } = props; const jwtToken = res.jwtToken; const userId = res.userId; // Save JWT and userId to localStorage localStorage.setItem('jwt_token', jwtToken); localStorage.setItem('user_id', userId); getCartList(userId); // Fetch user cart list history.replace('/'); // Redirect to home page on success } else { setState({ errorMsg: res.error_msg || 'Login failed. Please try again.' }); } } catch (error) { setState({ errorMsg: 'Wrong username or password' }); } }; const [state, setState] = React.useState({ username: '', password: '', errorMsg: '', }); const onChangeUsername = event => { setState(prevState => ({ ...prevState, username: event.target.value })); }; const onChangePassword = event => { setState(prevState => ({ ...prevState, password: event.target.value })); }; const { username, password, errorMsg } = state; return ( <div className=\"login-con\"> <div className=\"login-card\"> <h1 className=\"HomeLogo\">shoppy</h1> <form className=\"form\" onSubmit={onSubmit}> <label className=\"label\" htmlFor=\"user\"> USERNAME </label> <input className=\"inp\" type=\"text\" id=\"user\" onChange={onChangeUsername} value={username} placeholder=\"Enter your username\" /> <label className=\"label\" htmlFor=\"pass\"> PASSWORD </label> <input className=\"inp\" type=\"password\" id=\"pass\" onChange={onChangePassword} value={password} placeholder=\"Enter your password\" /> <button type=\"submit\" className=\"login-btn\"> Login </button> {errorMsg && <p className=\"err-msg\">{errorMsg}</p>} </form> </div> </div> ); }} </CartContext.Consumer> ); export "],"mappings":"AACA,OAAOA,WAAW,MAAM,2BAA2B,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module"}